{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport api from '@/services/api';\nimport { ref, onMounted } from 'vue';\nexport default {\n  setup() {\n    const showAccessWarning = ref(false);\n    onMounted(() => {\n      const userRole = localStorage.getItem('userRole');\n      const requiredRoles = ['admin', 'cashier', 'weigher']; // Define the required roles for this page\n\n      if (requiredRoles && !requiredRoles.includes(userRole)) {\n        showAccessWarning.value = true;\n      }\n    });\n    return {\n      showAccessWarning\n    };\n  },\n  data() {\n    return {\n      wastes: [],\n      newWaste: {\n        name: '',\n        description: '',\n        quantity: 0\n      },\n      showAddWasteForm: false,\n      showDeleteModal: false,\n      deleteWasteId: null,\n      isEditing: false,\n      editWasteId: null\n    };\n  },\n  created() {\n    this.fetchWastes();\n  },\n  methods: {\n    fetchWastes() {\n      api.getAllWaste().then(response => {\n        this.wastes = response.data;\n      }).catch(error => {\n        console.error('Error fetching wastes:', error);\n      });\n    },\n    toggleAddWasteForm() {\n      this.showAddWasteForm = !this.showAddWasteForm;\n      if (!this.showAddWasteForm) {\n        this.resetForm();\n      }\n    },\n    async submitForm() {\n      if (this.isEditing) {\n        await this.updateWaste();\n      } else {\n        await this.createWaste();\n      }\n    },\n    async createWaste() {\n      try {\n        const response = await api.createWaste(this.newWaste);\n        this.wastes.push(response.data);\n        this.resetForm();\n      } catch (error) {\n        console.error('Error creating waste:', error);\n      }\n    },\n    async updateWaste() {\n      try {\n        await api.updateWaste(this.editWasteId, this.newWaste);\n        const index = this.wastes.findIndex(waste => waste._id === this.editWasteId);\n        if (index !== -1) {\n          this.wastes.splice(index, 1, {\n            ...this.newWaste,\n            _id: this.editWasteId\n          });\n        }\n        this.resetForm();\n      } catch (error) {\n        console.error('Error updating waste:', error);\n      }\n    },\n    confirmDeleteWaste(waste) {\n      this.showDeleteModal = true;\n      this.deleteWasteId = waste._id;\n    },\n    async deleteWaste() {\n      try {\n        await api.deleteWaste(this.deleteWasteId);\n        this.wastes = this.wastes.filter(waste => waste._id !== this.deleteWasteId);\n        this.closeDeleteModal();\n      } catch (error) {\n        console.error('Error deleting waste:', error);\n      }\n    },\n    closeDeleteModal() {\n      this.showDeleteModal = false;\n      this.deleteWasteId = null;\n    },\n    editWaste(waste) {\n      this.newWaste = {\n        ...waste\n      };\n      this.editWasteId = waste._id;\n      this.isEditing = true;\n      this.showAddWasteForm = true;\n    },\n    cancelEdit() {\n      this.resetForm();\n    },\n    resetForm() {\n      this.newWaste = {\n        name: '',\n        description: '',\n        quantity: 0\n      };\n      this.isEditing = false;\n      this.editWasteId = null;\n      this.showAddWasteForm = false;\n    }\n  }\n};","map":{"version":3,"names":["api","ref","onMounted","setup","showAccessWarning","userRole","localStorage","getItem","requiredRoles","includes","value","data","wastes","newWaste","name","description","quantity","showAddWasteForm","showDeleteModal","deleteWasteId","isEditing","editWasteId","created","fetchWastes","methods","getAllWaste","then","response","catch","error","console","toggleAddWasteForm","resetForm","submitForm","updateWaste","createWaste","push","index","findIndex","waste","_id","splice","confirmDeleteWaste","deleteWaste","filter","closeDeleteModal","editWaste","cancelEdit"],"sources":["/home/edward/summer-project/frontend/src/components/forms/WasteForm.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div v-if=\"accessDenied\" class=\"warning\">\n      <p>You do not have access to this page.</p>\n    </div>\n    <table class=\"data-table\">\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Description</th>\n          <th>Quantity</th>\n          <th>Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"waste in wastes\" :key=\"waste._id\" class=\"data-item\">\n          <td>{{ waste.name }}</td>\n          <td>{{ waste.description }}</td>\n          <td>{{ waste.quantity }}</td>\n          <td class=\"action-buttons\">\n            <button class=\"btn edit-btn\" @click=\"editWaste(waste)\">Edit</button>\n            <button class=\"btn delete-btn\" @click=\"confirmDeleteWaste(waste)\">Delete</button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <!-- Toggle Add New Waste Form -->\n    <button @click=\"toggleAddWasteForm\" class=\"btn add-btn\">\n      {{ showAddWasteForm ? \"Cancel\" : \"Add Waste\" }}\n    </button>\n\n    <!-- Waste Form -->\n    <form v-if=\"showAddWasteForm\" @submit.prevent=\"submitForm\" class=\"data-form\">\n      <input v-model=\"newWaste.name\" placeholder=\"Name\" required  class=\"input-field\">\n      <input v-model=\"newWaste.description\" placeholder=\"Description\" required  class=\"input-field\">\n      <input v-model.number=\"newWaste.quantity\" type=\"number\" placeholder=\"Quantity\" required  class=\"input-field\">\n      <div class=\"form-buttons\">\n        <button type=\"submit\" class=\"btn submit-btn\">{{ isEditing ? 'Update' : 'Add' }} Waste</button>\n        <button type=\"button\" @click=\"cancelEdit\" v-if=\"isEditing\" class=\"btn cancel-btn\">Cancel</button>\n      </div>\n    </form>\n\n    <!-- Delete Confirmation Modal -->\n    <div v-if=\"showDeleteModal\" class=\"modal\">\n      <div class=\"modal-content\">\n        <p>Are you sure you want to delete this waste?</p>\n        <div class=\"modal-buttons\">\n          <button class=\"btn confirm-delete-btn\" @click=\"deleteWaste\">Yes, Delete</button>\n          <button class=\"btn cancel-btn\" @click=\"closeDeleteModal\">Cancel</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport api from '@/services/api';\nimport { ref, onMounted } from 'vue';\n\n\nexport default {\n  setup() {\n    const showAccessWarning = ref(false);\n\n    onMounted(() => {\n      const userRole = localStorage.getItem('userRole');\n      const requiredRoles = ['admin', 'cashier', 'weigher']; // Define the required roles for this page\n\n      if (requiredRoles && !requiredRoles.includes(userRole)) {\n        showAccessWarning.value = true;\n      }\n    });\n\n    return { showAccessWarning };\n  },\n  data() {\n    return {\n      wastes: [],\n      newWaste: {\n        name: '',\n        description: '',\n        quantity: 0\n      },\n      showAddWasteForm: false,\n      showDeleteModal: false,\n      deleteWasteId: null,\n      isEditing: false,\n      editWasteId: null\n    };\n  },\n  created() {\n    this.fetchWastes();\n  },\n  methods: {\n    fetchWastes() {\n      api.getAllWaste()\n        .then(response => {\n          this.wastes = response.data;\n        })\n        .catch(error => {\n          console.error('Error fetching wastes:', error);\n        });\n    },\n    toggleAddWasteForm() {\n      this.showAddWasteForm = !this.showAddWasteForm;\n      if (!this.showAddWasteForm) {\n        this.resetForm();\n      }\n    },\n    async submitForm() {\n      if (this.isEditing) {\n        await this.updateWaste();\n      } else {\n        await this.createWaste();\n      }\n    },\n    async createWaste() {\n      try {\n        const response = await api.createWaste(this.newWaste);\n        this.wastes.push(response.data);\n        this.resetForm();\n      } catch (error) {\n        console.error('Error creating waste:', error);\n      }\n    },\n    async updateWaste() {\n      try {\n        await api.updateWaste(this.editWasteId, this.newWaste);\n        const index = this.wastes.findIndex(waste => waste._id === this.editWasteId);\n        if (index !== -1) {\n          this.wastes.splice(index, 1, { ...this.newWaste, _id: this.editWasteId });\n        }\n        this.resetForm();\n      } catch (error) {\n        console.error('Error updating waste:', error);\n      }\n    },\n    confirmDeleteWaste(waste) {\n      this.showDeleteModal = true;\n      this.deleteWasteId = waste._id;\n    },\n    async deleteWaste() {\n      try {\n        await api.deleteWaste(this.deleteWasteId);\n        this.wastes = this.wastes.filter(waste => waste._id !== this.deleteWasteId);\n        this.closeDeleteModal();\n      } catch (error) {\n        console.error('Error deleting waste:', error);\n      }\n    },\n    closeDeleteModal() {\n      this.showDeleteModal = false;\n      this.deleteWasteId = null;\n    },\n    editWaste(waste) {\n      this.newWaste = { ...waste };\n      this.editWasteId = waste._id;\n      this.isEditing = true;\n      this.showAddWasteForm = true;\n    },\n    cancelEdit() {\n      this.resetForm();\n    },\n    resetForm() {\n      this.newWaste = {\n        name: '',\n        description: '',\n        quantity: 0\n      };\n      this.isEditing = false;\n      this.editWasteId = null;\n      this.showAddWasteForm = false;\n    }\n  }\n};\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}